<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhiteCrow - Vulnerability Assessment Report</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
        
        :root {
            --primary-color: #ed382d;
            --secondary-color: #4a6cf7;
            --text-color: #333333;
            --light-gray: #f5f5f5;
            --medium-gray: #e0e0e0;
            --dark-gray: #666666;
            --high-color: #dc3545;
            --medium-color: #ffc107;
            --low-color: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            color: var(--text-color);
            line-height: 1.6;
            background-color: white;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .page {
            page-break-after: always;
            padding: 40px 0;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 30px 0;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        h1, h2, h3, h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        h1 {
            font-size: 28px;
        }
        
        h2 {
            font-size: 24px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 8px;
            margin-top: 30px;
        }
        
        h3 {
            font-size: 20px;
            margin-top: 25px;
        }
        
        h4 {
            font-size: 18px;
            margin-top: 20px;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .legal-section {
            background-color: var(--light-gray);
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        
        .table-container {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        th {
            background-color: var(--light-gray);
            font-weight: 500;
        }
        
        tr:nth-child(even) {
            background-color: var(--light-gray);
        }
        
        .chart-container {
            margin: 30px 0;
            text-align: center;
        }
        
        .chart {
            max-width: 100%;
            height: auto;
            margin: 0 auto;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px 0;
            border-top: 1px solid var(--medium-gray);
            color: var(--dark-gray);
            font-size: 14px;
        }
        
        .page-number {
            text-align: center;
            font-size: 12px;
            color: var(--dark-gray);
            margin-top: 20px;
        }
        
        .toc {
            margin: 20px 0;
        }
        
        .toc-item {
            margin-bottom: 8px;
        }
        
        .toc-level-1 {
            font-weight: 500;
            margin-left: 0;
        }
        
        .toc-level-2 {
            margin-left: 20px;
        }
        
        .toc-level-3 {
            margin-left: 40px;
            font-size: 14px;
        }
        
        .severity-high {
            color: var(--high-color);
            font-weight: 500;
        }
        
        .severity-medium {
            color: var(--medium-color);
            font-weight: 500;
        }
        
        .severity-low {
            color: var(--low-color);
            font-weight: 500;
        }
        
        .finding {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .finding:last-child {
            border-bottom: none;
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .finding-title {
            font-size: 18px;
            font-weight: 500;
        }
        
        .finding-severity {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .severity-badge-high {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--high-color);
        }
        
        .severity-badge-medium {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--medium-color);
        }
        
        .severity-badge-low {
            background-color: rgba(23, 162, 184, 0.1);
            color: var(--low-color);
        }
        
        .finding-details {
            margin-left: 20px;
        }
        
        .finding-detail {
            margin-bottom: 10px;
        }
        
        .finding-label {
            font-weight: 500;
            display: inline-block;
            min-width: 100px;
        }
        
        .evidence-code {
            background-color: var(--light-gray);
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .summary-stats {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
        }
        
        .stat-card {
            flex: 1;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            margin: 0 10px;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--dark-gray);
        }
        
        .high-value {
            color: var(--high-color);
        }
        
        .medium-value {
            color: var(--medium-color);
        }
        
        .low-value {
            color: var(--low-color);
        }
        
        .cover-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .cover-title {
            font-size: 36px;
            margin-bottom: 20px;
        }
        
        .cover-subtitle {
            font-size: 24px;
            margin-bottom: 40px;
            color: var(--dark-gray);
        }
        
        .cover-details {
            margin-top: 60px;
            font-size: 16px;
        }
        
        .cover-date {
            margin-top: 10px;
            font-size: 16px;
        }
        
        @media print {
            .page {
                page-break-after: always;
            }
            
            body {
                font-size: 12pt;
            }
            
            h1 {
                font-size: 24pt;
            }
            
            h2 {
                font-size: 20pt;
            }
            
            h3 {
                font-size: 16pt;
            }
            
            .header {
                background-color: var(--primary-color) !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="page cover-page">
        <h1 class="cover-title">WhiteCrow Vulnerability Assessment Report</h1>
        <h2 class="cover-subtitle">{{ results.target }}</h2>
        
        <div class="cover-details">
            <p><strong>Report ID:</strong> {{ report_id }}</p>
            <p><strong>Prepared by:</strong> WhiteCrow</p>
            <p class="cover-date"><strong>Date:</strong> {{ current_date }}</p>
        </div>
    </div>
    
    <!-- Legal Page -->
    <div class="page">
        <div class="container">
            <h2>Legal</h2>
            
            <div class="legal-section">
                <h3>Confidentiality</h3>
                <p>This document contains sensitive and confidential information. It should not be shared with any third parties without written permission. The information contained in this report is intended solely for the use of the client.</p>
            </div>
            
            <div class="legal-section">
                <h3>Disclaimer</h3>
                <p>This report represents a point-in-time assessment of the target's security posture. Security is an ongoing process, and new vulnerabilities may emerge after this assessment. Regular security testing is recommended to maintain a strong security posture.</p>
                <p>The findings in this report are based on automated scanning techniques and may include false positives. Manual verification of findings is recommended before implementing remediation measures.</p>
            </div>
            
            <div class="legal-section">
                <h3>Change Log</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Version</th>
                            <th>Comments</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>{{ current_date }}</td>
                            <td>1.0</td>
                            <td>Initial Report</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Table of Contents -->
    <div class="page">
        <div class="container">
            <h2>Table of Contents</h2>
            
            <div class="toc">
                <div class="toc-item toc-level-1">1. Executive Summary</div>
                <div class="toc-item toc-level-1">2. Engagement Summary</div>
                <div class="toc-item toc-level-2">2.1 Scope</div>
                <div class="toc-item toc-level-2">2.2 Risk Ratings</div>
                <div class="toc-item toc-level-2">2.3 Findings Overview</div>
                <div class="toc-item toc-level-1">3. Technical Details</div>
                {% for vuln_type in results.vulnerabilities | groupby('type') %}
                <div class="toc-item toc-level-2">3.{{ loop.index }} {{ vuln_type.grouper }}</div>
                {% endfor %}
                <div class="toc-item toc-level-1">4. Remediation Summary</div>
            </div>
        </div>
    </div>
    
    <!-- Executive Summary -->
    <div class="page">
        <div class="container">
            <h2>1. Executive Summary</h2>
            
            <p>A security assessment was conducted on {{ results.target }} on {{ results.scan_time }}. The main goal of the engagement was to evaluate the security of the platform and identify possible threats and vulnerabilities.</p>
            
            <p>This report details the scope of the engagement, detailed information about all of the findings, and recommendations. The summary below is intended for non-technical audiences to give an idea of the overall results of the engagement and the key findings. The technical details section of this report is intended for a technical audience as it lists all of our findings in detail, along with reproduction steps, analysis, and recommendations.</p>
            
            {% set high_count = results.vulnerabilities | selectattr('severity', 'equalto', 'High') | list | length %}
            {% set medium_count = results.vulnerabilities | selectattr('severity', 'equalto', 'Medium') | list | length %}
            {% set low_count = results.vulnerabilities | selectattr('severity', 'equalto', 'Low') | list | length %}
            
            {% if high_count > 0 %}
                <p>Based on the security assessment we carried out for {{ results.target }} and based on our findings, the current risk rating is <span class="severity-high">high</span>. The vulnerabilities discovered can be used by malicious actors to cause breaches and even gain unauthorized access to sensitive information.</p>
            {% elif medium_count > 0 %}
                <p>Based on the security assessment we carried out for {{ results.target }} and based on our findings, the current risk rating is <span class="severity-medium">medium</span>. The vulnerabilities discovered could potentially be exploited by determined attackers to compromise certain aspects of the system.</p>
            {% else %}
                <p>Based on the security assessment we carried out for {{ results.target }} and based on our findings, the current risk rating is <span class="severity-low">low</span>. While some minor vulnerabilities were discovered, they pose minimal risk to the overall security of the system.</p>
            {% endif %}
            
            <div class="chart-container">
                <h3>Vulnerability Distribution by Severity</h3>
                <img class="chart" src="data:image/png;base64,{{ severity_chart }}" alt="Vulnerabilities by Severity">
            </div>
            
            <div class="summary-stats">
                <div class="stat-card">
                    <div class="stat-value high-value">{{ high_count }}</div>
                    <div class="stat-label">High Severity</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value medium-value">{{ medium_count }}</div>
                    <div class="stat-label">Medium Severity</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value low-value">{{ low_count }}</div>
                    <div class="stat-label">Low Severity</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Engagement Summary -->
    <div class="page">
        <div class="container">
            <h2>2. Engagement Summary</h2>
            
            <h3>2.1 Scope</h3>
            <p>The security assessment was carried out on the following target:</p>
            <ul>
                <li>{{ results.target }}</li>
            </ul>
            
            <h3>2.2 Risk Ratings</h3>
            <p>The vulnerability risk was calculated based on the Common Vulnerability Scoring System (CVSS v3.0) which is the industry standard for assessing the severity of security vulnerabilities.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Risk</th>
                        <th>CVSS v3.0 Score</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="severity-high">High</td>
                        <td>7.0 - 10.0</td>
                        <td>Vulnerabilities that can be easily exploited and result in significant damage or impact.</td>
                    </tr>
                    <tr>
                        <td class="severity-medium">Medium</td>
                        <td>4.0 - 6.9</td>
                        <td>Vulnerabilities that may be more difficult to exploit but could still lead to some compromise of the target's security.</td>
                    </tr>
                    <tr>
                        <td class="severity-low">Low</td>
                        <td>0.1 - 3.9</td>
                        <td>Vulnerabilities that may be even more difficult to exploit and may not result in a significant compromise.</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>2.3 Findings Overview</h3>
            
            <div class="chart-container">
                <h4>Vulnerability Distribution by Type</h4>
                <img class="chart" src="data:image/png;base64,{{ vulnerability_types_chart }}" alt="Vulnerabilities by Type">
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Vulnerability Type</th>
                            <th>Count</th>
                            <th>Highest Severity</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for vuln_type, vulns in results.vulnerabilities | groupby('type') %}
                        <tr>
                            <td>{{ vuln_type }}</td>
                            <td>{{ vulns | list | length }}</td>
                            <td class="severity-{{ vulns | map(attribute='severity') | map('lower') | list | max }}">
                                {{ vulns | map(attribute='severity') | list | max }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Technical Details -->
    <div class="page">
        <div class="container">
            <h2>3. Technical Details</h2>
            
            {% for vuln_type, vulns in results.vulnerabilities | groupby('type') %}
            <h3>3.{{ loop.index }} {{ vuln_type }}</h3>
            
            {% for vuln in vulns %}
            <div class="finding">
                <div class="finding-header">
                    <div class="finding-title">Finding #{{ loop.index }}</div>
                    <div class="finding-severity severity-badge-{{ vuln.severity | lower }}">{{ vuln.severity }}</div>
                </div>
                
                <div class="finding-details">
                    <div class="finding-detail">
                        <span class="finding-label">URL:</span> {{ vuln.url }}
                    </div>
                    
                    {% if vuln.parameter %}
                    <div class="finding-detail">
                        <span class="finding-label">Parameter:</span> {{ vuln.parameter }}
                    </div>
                    {% endif %}
                    
                    {% if vuln.evidence %}
                    <div class="finding-detail">
                        <span class="finding-label">Evidence:</span>
                        <div class="evidence-code">{{ vuln.evidence }}</div>
                    </div>
                    {% endif %}
                    
                    <div class="finding-detail">
                        <span class="finding-label">Description:</span> {{ vuln.description }}
                    </div>
                    
                    <div class="finding-detail">
                        <span class="finding-label">Remediation:</span> {{ vuln.remediation }}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endfor %}
        </div>
    </div>
    
    <!-- Remediation Summary -->
    <div class="page">
        <div class="container">
            <h2>4. Remediation Summary</h2>
            
            <p>The following actions are recommended to address the identified vulnerabilities:</p>
            
            <ul>
                {% for remediation in results.vulnerabilities | map(attribute='remediation') | unique | list %}
                <li>{{ remediation }}</li>
                {% endfor %}
            </ul>
            
            <p>It is recommended to address high severity vulnerabilities first, followed by medium and then low severity issues. After implementing the recommended fixes, a follow-up security assessment should be conducted to verify that the vulnerabilities have been properly addressed.</p>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
        <p>Web Vulnerability Assessment Report - {{ current_date }}</p>
        <p>Generated by Web Vulnerability Scanner</p>
    </div>
</body>
</html>